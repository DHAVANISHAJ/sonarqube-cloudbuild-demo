steps:
  - name: 'sonarsource/sonar-scanner-cli'
    entrypoint: 'sh'
    args:
      - '-c'
      - |
        sonar-scanner \
          -Dsonar.projectKey=YOUR_PROJECT_KEY \
          -Dsonar.organization=YOUR_ORG \
          -Dsonar.sources=. \
          -Dsonar.host.url=https://sonarcloud.io \
          -Dsonar.login=$SONAR_TOKEN
substitutions:
  _SONAR_TOKEN: "YOUR_SONARQUBE_TOKEN"
availableSecrets:
  secretManager:
    - versionName: projects/$PROJECT_ID/secrets/sonar-token/versions/latest
      env: SONAR_TOKEN
